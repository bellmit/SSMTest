require({cache:{"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(t,e,i,s,r){return r=i("dojox.gfx.path.Path",r.Shape,{constructor:function(i){this.shape=e.clone(t.defaultPath),this.segments=[],this.tbbox=null,this.absolute=!0,this.last={},this.rawNode=i,this.segmented=!1},setAbsoluteMode:function(t){return this._confirmSegmented(),this.absolute="string"==typeof t?"absolute"==t:t,this},getAbsoluteMode:function(){return this._confirmSegmented(),this.absolute},getBoundingBox:function(){return this._confirmSegmented(),this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){if(this._confirmSegmented(),this.tbbox)return this.tbbox;var t=this.bbox,e=this._getRealMatrix();this.bbox=null;for(var i=0,s=this.segments.length;s>i;++i)this._updateWithSegment(this.segments[i],e);return e=this.bbox,this.bbox=t,this.tbbox=e?[{x:e.l,y:e.t},{x:e.r,y:e.t},{x:e.r,y:e.b},{x:e.l,y:e.b}]:null},getLastPosition:function(){return this._confirmSegmented(),"x"in this.last?this.last:null},_applyTransform:function(){return this.tbbox=null,this.inherited(arguments)},_updateBBox:function(t,e,i){i&&(e=s.multiplyPoint(i,t,e),t=e.x,e=e.y),this.bbox&&"l"in this.bbox?(this.bbox.l>t&&(this.bbox.l=t),this.bbox.r<t&&(this.bbox.r=t),this.bbox.t>e&&(this.bbox.t=e),this.bbox.b<e&&(this.bbox.b=e)):this.bbox={l:t,b:e,r:t,t:e}},_updateWithSegment:function(e,i){var s,r=e.args,n=r.length;switch(e.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(s=0;n>s;s+=2)this._updateBBox(r[s],r[s+1],i);this.last.x=r[n-2],this.last.y=r[n-1],this.absolute=!0;break;case"H":for(s=0;n>s;++s)this._updateBBox(r[s],this.last.y,i);this.last.x=r[n-1],this.absolute=!0;break;case"V":for(s=0;n>s;++s)this._updateBBox(this.last.x,r[s],i);this.last.y=r[n-1],this.absolute=!0;break;case"m":s=0,"x"in this.last||(this._updateBBox(this.last.x=r[0],this.last.y=r[1],i),s=2);for(;n>s;s+=2)this._updateBBox(this.last.x+=r[s],this.last.y+=r[s+1],i);this.absolute=!1;break;case"l":case"t":for(s=0;n>s;s+=2)this._updateBBox(this.last.x+=r[s],this.last.y+=r[s+1],i);this.absolute=!1;break;case"h":for(s=0;n>s;++s)this._updateBBox(this.last.x+=r[s],this.last.y,i);this.absolute=!1;break;case"v":for(s=0;n>s;++s)this._updateBBox(this.last.x,this.last.y+=r[s],i);this.absolute=!1;break;case"c":for(s=0;n>s;s+=6)this._updateBBox(this.last.x+r[s],this.last.y+r[s+1],i),this._updateBBox(this.last.x+r[s+2],this.last.y+r[s+3],i),this._updateBBox(this.last.x+=r[s+4],this.last.y+=r[s+5],i);this.absolute=!1;break;case"s":case"q":for(s=0;n>s;s+=4)this._updateBBox(this.last.x+r[s],this.last.y+r[s+1],i),this._updateBBox(this.last.x+=r[s+2],this.last.y+=r[s+3],i);this.absolute=!1;break;case"A":for(s=0;n>s;s+=7)this._updateBBox(r[s+5],r[s+6],i);this.last.x=r[n-2],this.last.y=r[n-1],this.absolute=!0;break;case"a":for(s=0;n>s;s+=7)this._updateBBox(this.last.x+=r[s+5],this.last.y+=r[s+6],i);this.absolute=!1}var o=[e.action];for(s=0;n>s;++s)o.push(t.formatNumber(r[s],!0));if("string"==typeof this.shape.path)this.shape.path+=o.join("");else for(s=0,n=o.length;n>s;++s)this.shape.path.push(o[s])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(t,e){this.tbbox=null;var i=this._validSegments[t.toLowerCase()];"number"==typeof i&&(i?e.length>=i&&(i={action:t,args:e.slice(0,e.length-e.length%i)},this.segments.push(i),this._updateWithSegment(i)):(i={action:t,args:[]},this.segments.push(i),this._updateWithSegment(i)))},_collectArgs:function(t,e){for(var i=0;i<e.length;++i){var s=e[i];"boolean"==typeof s?t.push(s?1:0):"number"==typeof s?t.push(s):s instanceof Array?this._collectArgs(t,s):"x"in s&&"y"in s&&t.push(s.x,s.y)}},moveTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"M":"m",t),this},lineTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"L":"l",t),this},hLineTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"H":"h",t),this},vLineTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"V":"v",t),this},curveTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"C":"c",t),this},smoothCurveTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"S":"s",t),this},qCurveTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"Q":"q",t),this},qSmoothCurveTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"T":"t",t),this},arcTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"A":"a",t),this},closePath:function(){return this._confirmSegmented(),this._pushSegment("Z",[]),this},_confirmSegmented:function(){if(!this.segmented){var t=this.shape.path;this.shape.path=[],this._setPath(t),this.shape.path=this.shape.path.join(""),this.segmented=!0}},_setPath:function(i){if(i=e.isArray(i)?i:i.match(t.pathSvgRegExp),this.segments=[],this.absolute=!0,this.bbox={},this.last={},i){for(var s="",r=[],n=i.length,o=0;n>o;++o){var a=i[o],h=parseFloat(a);isNaN(h)?(s&&this._pushSegment(s,r),r=[],s=a):r.push(h)}this._pushSegment(s,r)}},setShape:function(e){return this.inherited(arguments,["string"==typeof e?{path:e}:e]),this.segmented=!1,this.segments=[],t.lazyPathSegmentation||this._confirmSegmented(),this},_2PI:2*Math.PI}),i=i("dojox.gfx.path.TextPath",r,{constructor:function(){"text"in this||(this.text=e.clone(t.defaultTextPath)),"fontStyle"in this||(this.fontStyle=e.clone(t.defaultFont))},getText:function(){return this.text},setText:function(e){return this.text=t.makeParameters(this.text,"string"==typeof e?{text:e}:e),this._setText(),this},getFont:function(){return this.fontStyle},setFont:function(e){return this.fontStyle="string"==typeof e?t.splitFontString(e):t.makeParameters(t.defaultFont,e),this._setFont(),this}}),t.path={Path:r,TextPath:i}})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(t,e,i,s,r,n,o,a,h,l){var u=t.shape={};return u.Shape=i("dojox.gfx.shape.Shape",null,{constructor:function(){if(this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null,r("gfxRegistry")){var t=u.register(this);this.getUID=function(){return t}}},destroy:function(){r("gfxRegistry")&&u.dispose(this),this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null),this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var t=this.getBoundingBox();if(!t)return null;var e=this._getRealMatrix();return[l.multiplyPoint(e,t.x,t.y),l.multiplyPoint(e,t.x+t.width,t.y),l.multiplyPoint(e,t.x+t.width,t.y+t.height),l.multiplyPoint(e,t.x,t.y+t.height)]},getEventSource:function(){return this.rawNode},setClip:function(t){this.clip=t},getClip:function(){return this.clip},setShape:function(e){return this.shape=t.makeParameters(this.shape,e),this.bbox=null,this},setFill:function(e){if(!e)return this.fillStyle=null,this;var i=null;if("object"==typeof e&&"type"in e)switch(e.type){case"linear":i=t.makeParameters(t.defaultLinearGradient,e);break;case"radial":i=t.makeParameters(t.defaultRadialGradient,e);break;case"pattern":i=t.makeParameters(t.defaultPattern,e)}else i=t.normalizeColor(e);return this.fillStyle=i,this},setStroke:function(i){return i?(("string"==typeof i||e.isArray(i)||i instanceof h)&&(i={color:i}),i=this.strokeStyle=t.makeParameters(t.defaultStroke,i),i.color=t.normalizeColor(i.color),this):(this.strokeStyle=null,this)},setTransform:function(t){return this.matrix=l.clone(t?l.normalize(t):l.identity),this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var t=this.getParent();return t&&(t._moveChildToFront(this),this._moveToFront()),this},moveToBack:function(){var t=this.getParent();return t&&(t._moveChildToBack(this),this._moveToBack()),this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(t){return t?this.setTransform([this.matrix,t]):this},applyLeftTransform:function(t){return t?this.setTransform([t,this.matrix]):this},applyTransform:function(t){return t?this.setTransform([this.matrix,t]):this},removeShape:function(t){return this.parent&&this.parent.remove(this,t),this},_setParent:function(t,e){return this.parent=t,this._updateParentMatrix(e)},_updateParentMatrix:function(t){return this.parentMatrix=t?l.clone(t):null,this._applyTransform()},_getRealMatrix:function(){for(var t=this.matrix,e=this.parent;e;)e.matrix&&(t=l.multiply(e.matrix,t)),e=e.parent;return t}}),u._eventsProcessing={on:function(e,i){return n(this.getEventSource(),e,u.fixCallback(this,t.fixTarget,i))},connect:function(t,i,s){return"on"==t.substring(0,2)&&(t=t.substring(2)),this.on(t,s?e.hitch(i,s):i)},disconnect:function(t){return t.remove()}},u.fixCallback=function(t,i,r,n){if(n||(n=r,r=null),e.isString(n)){if(r=r||s.global,!r[n])throw['dojox.gfx.shape.fixCallback: scope["',n,'"] is null (scope="',r,'")'].join("");return function(e){return i(e,t)?r[n].apply(r,arguments||[]):void 0}}return r?function(e){return i(e,t)?n.apply(r,arguments||[]):void 0}:function(e){return i(e,t)?n.apply(r,arguments):void 0}},e.extend(u.Shape,u._eventsProcessing),u.Container={_init:function(){this.children=[],this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(t){var e=t.getParent();return e&&e.remove(t,!0),this.children.push(t),t._setParent(this,this._getRealMatrix())},remove:function(t,e){for(var i=0;i<this.children.length;++i)if(this.children[i]==t){e||(t.parent=null,t.parentMatrix=null),this.children.splice(i,1);break}return this},clear:function(t){for(var e,i=0;i<this.children.length;++i)e=this.children[i],e.parent=null,e.parentMatrix=null,t&&e.destroy();return this.children=[],this},getBoundingBox:function(){if(this.children){var t=null;return o.forEach(this.children,function(e){var i=e.getBoundingBox();i&&((e=e.getTransform())&&(i=l.multiplyRectangle(e,i)),t?(t.x=Math.min(t.x,i.x),t.y=Math.min(t.y,i.y),t.endX=Math.max(t.endX,i.x+i.width),t.endY=Math.max(t.endY,i.y+i.height)):t={x:i.x,y:i.y,endX:i.x+i.width,endY:i.y+i.height})}),t&&(t.width=t.endX-t.x,t.height=t.endY-t.y),t}return null},_moveChildToFront:function(t){for(var e=0;e<this.children.length;++e)if(this.children[e]==t){this.children.splice(e,1),this.children.push(t);break}return this},_moveChildToBack:function(t){for(var e=0;e<this.children.length;++e)if(this.children[e]==t){this.children.splice(e,1),this.children.unshift(t);break}return this}},u.Surface=i("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null,this._nodes=[],this._events=[]},destroy:function(){if(o.forEach(this._nodes,a.destroy),this._nodes=[],o.forEach(this._events,function(t){t&&t.remove()}),this._events=[],this.rawNode=null,r("ie"))for(;this._parent.lastChild;)a.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(){},whenLoaded:function(t,i){var s=e.hitch(t,i);this.isLoaded?s(this):n.once(this,"load",function(t){s(t)})}}),e.extend(u.Surface,u._eventsProcessing),u.Rect=i("dojox.gfx.shape.Rect",u.Shape,{constructor:function(e){this.shape=t.getDefault("Rect"),this.rawNode=e},getBoundingBox:function(){return this.shape}}),u.Ellipse=i("dojox.gfx.shape.Ellipse",u.Shape,{constructor:function(e){this.shape=t.getDefault("Ellipse"),this.rawNode=e},getBoundingBox:function(){if(!this.bbox){var t=this.shape;this.bbox={x:t.cx-t.rx,y:t.cy-t.ry,width:2*t.rx,height:2*t.ry}}return this.bbox}}),u.Circle=i("dojox.gfx.shape.Circle",u.Shape,{constructor:function(e){this.shape=t.getDefault("Circle"),this.rawNode=e},getBoundingBox:function(){if(!this.bbox){var t=this.shape;this.bbox={x:t.cx-t.r,y:t.cy-t.r,width:2*t.r,height:2*t.r}}return this.bbox}}),u.Line=i("dojox.gfx.shape.Line",u.Shape,{constructor:function(e){this.shape=t.getDefault("Line"),this.rawNode=e},getBoundingBox:function(){if(!this.bbox){var t=this.shape;this.bbox={x:Math.min(t.x1,t.x2),y:Math.min(t.y1,t.y2),width:Math.abs(t.x2-t.x1),height:Math.abs(t.y2-t.y1)}}return this.bbox}}),u.Polyline=i("dojox.gfx.shape.Polyline",u.Shape,{constructor:function(e){this.shape=t.getDefault("Polyline"),this.rawNode=e},setShape:function(t,e){return t&&t instanceof Array?(this.inherited(arguments,[{points:t}]),e&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[t]),this},_normalizePoints:function(){var t=this.shape.points,e=t&&t.length;if(e&&"number"==typeof t[0]){for(var i=[],s=0;e>s;s+=2)i.push({x:t[s],y:t[s+1]});this.shape.points=i}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var t=this.shape.points,e=t.length,i=t[0],s=i.x,r=i.y,n=i.x,o=i.y,a=1;e>a;++a)i=t[a],s>i.x&&(s=i.x),n<i.x&&(n=i.x),r>i.y&&(r=i.y),o<i.y&&(o=i.y);this.bbox={x:s,y:r,width:n-s,height:o-r}}return this.bbox}}),u.Image=i("dojox.gfx.shape.Image",u.Shape,{constructor:function(e){this.shape=t.getDefault("Image"),this.rawNode=e},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}}),u.Text=i(u.Shape,{constructor:function(e){this.fontStyle=null,this.shape=t.getDefault("Text"),this.rawNode=e},getFont:function(){return this.fontStyle},setFont:function(e){return this.fontStyle="string"==typeof e?t.splitFontString(e):t.makeParameters(t.defaultFont,e),this._setFont(),this},getBoundingBox:function(){var e=null;return this.getShape().text&&(e=t._base._computeTextBoundingBox(this)),e}}),u.Creator={createShape:function(e){switch(e.type){case t.defaultPath.type:return this.createPath(e);case t.defaultRect.type:return this.createRect(e);case t.defaultCircle.type:return this.createCircle(e);case t.defaultEllipse.type:return this.createEllipse(e);case t.defaultLine.type:return this.createLine(e);case t.defaultPolyline.type:return this.createPolyline(e);case t.defaultImage.type:return this.createImage(e);case t.defaultText.type:return this.createText(e);case t.defaultTextPath.type:return this.createTextPath(e)}return null},createGroup:function(){return this.createObject(t.Group)},createRect:function(e){return this.createObject(t.Rect,e)},createEllipse:function(e){return this.createObject(t.Ellipse,e)},createCircle:function(e){return this.createObject(t.Circle,e)},createLine:function(e){return this.createObject(t.Line,e)},createPolyline:function(e){return this.createObject(t.Polyline,e)},createImage:function(e){return this.createObject(t.Image,e)},createText:function(e){return this.createObject(t.Text,e)},createPath:function(e){return this.createObject(t.Path,e)},createTextPath:function(e){return this.createObject(t.TextPath,{}).setText(e)},createObject:function(){return null}},u})},"*noref":1}}),define("dojox/gfx/svg","dojo/_base/lang dojo/_base/sniff dojo/_base/window dojo/dom dojo/_base/declare dojo/_base/array dojo/dom-geometry dojo/dom-attr dojo/_base/Color ./_base ./shape ./path".split(" "),function(t,e,i,s,r,n,o,a,h,l,u,d){function c(t,e){return i.doc.createElementNS?i.doc.createElementNS(t,e):i.doc.createElement(e)}function f(t){return p.useSvgWeb?i.doc.createTextNode(t,!0):i.doc.createTextNode(t)}var p=l.svg={};p.useSvgWeb="undefined"!=typeof window.svgweb;var g=navigator.userAgent,x=e("ios"),b=e("android"),m=e("chrome")||b&&b>=4?"auto":"optimizeLegibility";p.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"},p.getRef=function(t){return t&&"none"!=t?t.match(/^url\(#.+\)$/)?s.byId(t.slice(5,-1)):t.match(/^#dojoUnique\d+$/)?s.byId(t.slice(1)):null:null},p.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};var y=0;p.Shape=r("dojox.gfx.svg.Shape",u.Shape,{destroy:function(){if(this.fillStyle&&"type"in this.fillStyle){var t=this.rawNode.getAttribute("fill");(t=p.getRef(t))&&t.parentNode.removeChild(t)}this.clip&&(t=this.rawNode.getAttribute("clip-path"))&&(t=s.byId(t.match(/gfx_clip[\d]+/)[0]))&&t.parentNode.removeChild(t),u.Shape.prototype.destroy.apply(this,arguments)},setFill:function(t){if(!t)return this.fillStyle=null,this.rawNode.setAttribute("fill","none"),this.rawNode.setAttribute("fill-opacity",0),this;var e,i=function(t){this.setAttribute(t,e[t].toFixed(8))};if("object"==typeof t&&"type"in t){switch(t.type){case"linear":e=l.makeParameters(l.defaultLinearGradient,t),t=this._setFillObject(e,"linearGradient"),n.forEach(["x1","y1","x2","y2"],i,t);break;case"radial":e=l.makeParameters(l.defaultRadialGradient,t),t=this._setFillObject(e,"radialGradient"),n.forEach(["cx","cy","r"],i,t);break;case"pattern":e=l.makeParameters(l.defaultPattern,t),t=this._setFillObject(e,"pattern"),n.forEach(["x","y","width","height"],i,t)}return this.fillStyle=e,this}return this.fillStyle=e=l.normalizeColor(t),this.rawNode.setAttribute("fill",e.toCss()),this.rawNode.setAttribute("fill-opacity",e.a),this.rawNode.setAttribute("fill-rule","evenodd"),this},setStroke:function(e){var i=this.rawNode;if(!e)return this.strokeStyle=null,i.setAttribute("stroke","none"),i.setAttribute("stroke-opacity",0),this;if(("string"==typeof e||t.isArray(e)||e instanceof h)&&(e={color:e}),e=this.strokeStyle=l.makeParameters(l.defaultStroke,e),e.color=l.normalizeColor(e.color),e){i.setAttribute("stroke",e.color.toCss()),i.setAttribute("stroke-opacity",e.color.a),i.setAttribute("stroke-width",e.width),i.setAttribute("stroke-linecap",e.cap),"number"==typeof e.join?(i.setAttribute("stroke-linejoin","miter"),i.setAttribute("stroke-miterlimit",e.join)):i.setAttribute("stroke-linejoin",e.join);var s=e.style.toLowerCase();if(s in p.dasharray&&(s=p.dasharray[s]),s instanceof Array){var r,s=t._toArray(s);for(r=0;r<s.length;++r)s[r]*=e.width;if("butt"!=e.cap){for(r=0;r<s.length;r+=2)s[r]-=e.width,1>s[r]&&(s[r]=1);for(r=1;r<s.length;r+=2)s[r]+=e.width}s=s.join(",")}i.setAttribute("stroke-dasharray",s),i.setAttribute("dojoGfxStrokeStyle",e.style)}return this},_getParentSurface:function(){for(var t=this.parent;t&&!(t instanceof l.Surface);t=t.parent);return t},_setFillObject:function(t,e){var i=p.xmlns.svg;this.fillStyle=t;var s=this._getParentSurface().defNode,r=this.rawNode.getAttribute("fill");if(r=p.getRef(r))if(r.tagName.toLowerCase()!=e.toLowerCase()){var n=r.id;r.parentNode.removeChild(r),r=c(i,e),r.setAttribute("id",n),s.appendChild(r)}else for(;r.childNodes.length;)r.removeChild(r.lastChild);else r=c(i,e),r.setAttribute("id",l._base._getUniqueId()),s.appendChild(r);if("pattern"==e)r.setAttribute("patternUnits","userSpaceOnUse"),i=c(i,"image"),i.setAttribute("x",0),i.setAttribute("y",0),i.setAttribute("width",t.width.toFixed(8)),i.setAttribute("height",t.height.toFixed(8)),i.setAttributeNS?i.setAttributeNS(p.xmlns.xlink,"xlink:href",t.src):i.setAttribute("xlink:href",t.src),r.appendChild(i);else for(s=0;s<t.colors.length;++s){var n=t.colors[s],o=c(i,"stop"),a=n.color=l.normalizeColor(n.color);o.setAttribute("offset",n.offset.toFixed(8)),o.setAttribute("stop-color",a.toCss()),o.setAttribute("stop-opacity",a.a),r.appendChild(o)}return this.rawNode.setAttribute("fill","url(#"+r.getAttribute("id")+")"),this.rawNode.removeAttribute("fill-opacity"),this.rawNode.setAttribute("fill-rule","evenodd"),r},_applyTransform:function(){if(this.matrix){var t=this.matrix;this.rawNode.setAttribute("transform","matrix("+t.xx.toFixed(8)+","+t.yx.toFixed(8)+","+t.xy.toFixed(8)+","+t.yy.toFixed(8)+","+t.dx.toFixed(8)+","+t.dy.toFixed(8)+")")}else this.rawNode.removeAttribute("transform");return this},setRawNode:function(t){t=this.rawNode=t,"image"!=this.shape.type&&t.setAttribute("fill","none"),t.setAttribute("fill-opacity",0),t.setAttribute("stroke","none"),t.setAttribute("stroke-opacity",0),t.setAttribute("stroke-width",1),t.setAttribute("stroke-linecap","butt"),t.setAttribute("stroke-linejoin","miter"),t.setAttribute("stroke-miterlimit",4),t.__gfxObject__=this},setShape:function(t){this.shape=l.makeParameters(this.shape,t);for(var e in this.shape)"type"!=e&&this.rawNode.setAttribute(e,this.shape[e]);return this.bbox=null,this},_moveToFront:function(){return this.rawNode.parentNode.appendChild(this.rawNode),this},_moveToBack:function(){return this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild),this},setClip:function(e){this.inherited(arguments);var i=e?"width"in e?"rect":"cx"in e?"ellipse":"points"in e?"polyline":"d"in e?"path":null:null;if(e&&!i)return this;"polyline"===i&&(e=t.clone(e),e.points=e.points.join(","));var r,n=a.get(this.rawNode,"clip-path");return n&&(r=s.byId(n.match(/gfx_clip[\d]+/)[0]))&&r.removeChild(r.childNodes[0]),e?(r?(i=c(p.xmlns.svg,i),r.appendChild(i)):(n="gfx_clip"+ ++y,this.rawNode.setAttribute("clip-path","url(#"+n+")"),r=c(p.xmlns.svg,"clipPath"),i=c(p.xmlns.svg,i),r.appendChild(i),this.rawNode.parentNode.insertBefore(r,this.rawNode),a.set(r,"id",n)),a.set(i,e)):(this.rawNode.removeAttribute("clip-path"),r&&r.parentNode.removeChild(r)),this},_removeClipNode:function(){var t,e=a.get(this.rawNode,"clip-path");return e&&(t=s.byId(e.match(/gfx_clip[\d]+/)[0]))&&t.parentNode.removeChild(t),t}}),p.Group=r("dojox.gfx.svg.Group",p.Shape,{constructor:function(){u.Container._init.call(this)},setRawNode:function(t){this.rawNode=t,this.rawNode.__gfxObject__=this},destroy:function(){this.clear(!0),p.Shape.prototype.destroy.apply(this,arguments)}}),p.Group.nodeType="g",p.Rect=r("dojox.gfx.svg.Rect",[p.Shape,u.Rect],{setShape:function(t){this.shape=l.makeParameters(this.shape,t),this.bbox=null;for(var e in this.shape)"type"!=e&&"r"!=e&&this.rawNode.setAttribute(e,this.shape[e]);return null!=this.shape.r&&(this.rawNode.setAttribute("ry",this.shape.r),this.rawNode.setAttribute("rx",this.shape.r)),this}}),p.Rect.nodeType="rect",p.Ellipse=r("dojox.gfx.svg.Ellipse",[p.Shape,u.Ellipse],{}),p.Ellipse.nodeType="ellipse",p.Circle=r("dojox.gfx.svg.Circle",[p.Shape,u.Circle],{}),p.Circle.nodeType="circle",p.Line=r("dojox.gfx.svg.Line",[p.Shape,u.Line],{}),p.Line.nodeType="line",p.Polyline=r("dojox.gfx.svg.Polyline",[p.Shape,u.Polyline],{setShape:function(t,e){t&&t instanceof Array?(this.shape=l.makeParameters(this.shape,{points:t}),e&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.shape=l.makeParameters(this.shape,t),this.bbox=null,this._normalizePoints();for(var i=[],s=this.shape.points,r=0;r<s.length;++r)i.push(s[r].x.toFixed(8),s[r].y.toFixed(8));return this.rawNode.setAttribute("points",i.join(" ")),this}}),p.Polyline.nodeType="polyline",p.Image=r("dojox.gfx.svg.Image",[p.Shape,u.Image],{setShape:function(t){this.shape=l.makeParameters(this.shape,t),this.bbox=null,t=this.rawNode;for(var e in this.shape)"type"!=e&&"src"!=e&&t.setAttribute(e,this.shape[e]);return t.setAttribute("preserveAspectRatio","none"),t.setAttributeNS?t.setAttributeNS(p.xmlns.xlink,"xlink:href",this.shape.src):t.setAttribute("xlink:href",this.shape.src),t.__gfxObject__=this,this}}),p.Image.nodeType="image",p.Text=r("dojox.gfx.svg.Text",[p.Shape,u.Text],{setShape:function(t){this.shape=l.makeParameters(this.shape,t),this.bbox=null,t=this.rawNode;var e=this.shape;return t.setAttribute("x",e.x),t.setAttribute("y",e.y),t.setAttribute("text-anchor",e.align),t.setAttribute("text-decoration",e.decoration),t.setAttribute("rotate",e.rotated?90:0),t.setAttribute("kerning",e.kerning?"auto":0),t.setAttribute("text-rendering",m),t.firstChild?t.firstChild.nodeValue=e.text:t.appendChild(f(e.text)),this},getTextWidth:function(){var t=this.rawNode,e=t.parentNode,t=t.cloneNode(!0);t.style.visibility="hidden";var i=0,s=t.firstChild.nodeValue;if(e.appendChild(t),""!=s)for(;!i;)i=t.getBBox?parseInt(t.getBBox().width):68;return e.removeChild(t),i},getBoundingBox:function(){var t=null;if(this.getShape().text)try{t=this.rawNode.getBBox()}catch(e){t={x:0,y:0,width:0,height:0}}return t}}),p.Text.nodeType="text",p.Path=r("dojox.gfx.svg.Path",[p.Shape,d.Path],{_updateWithSegment:function(){this.inherited(arguments),"string"==typeof this.shape.path&&this.rawNode.setAttribute("d",this.shape.path)},setShape:function(){return this.inherited(arguments),this.shape.path?this.rawNode.setAttribute("d",this.shape.path):this.rawNode.removeAttribute("d"),this}}),p.Path.nodeType="path",p.TextPath=r("dojox.gfx.svg.TextPath",[p.Shape,d.TextPath],{_updateWithSegment:function(){this.inherited(arguments),this._setTextPath()},setShape:function(){return this.inherited(arguments),this._setTextPath(),this},_setTextPath:function(){if("string"==typeof this.shape.path){var t=this.rawNode;if(!t.firstChild){var e=c(p.xmlns.svg,"textPath"),i=f("");e.appendChild(i),t.appendChild(e)}if(e=(e=t.firstChild.getAttributeNS(p.xmlns.xlink,"href"))&&p.getRef(e),!e&&(i=this._getParentSurface())){var i=i.defNode,e=c(p.xmlns.svg,"path"),s=l._base._getUniqueId();e.setAttribute("id",s),i.appendChild(e),t.firstChild.setAttributeNS?t.firstChild.setAttributeNS(p.xmlns.xlink,"xlink:href","#"+s):t.firstChild.setAttribute("xlink:href","#"+s)}e&&e.setAttribute("d",this.shape.path)}},_setText:function(){var t=this.rawNode;if(!t.firstChild){var e=c(p.xmlns.svg,"textPath"),i=f("");e.appendChild(i),t.appendChild(e)}switch(t=t.firstChild,e=this.text,t.setAttribute("alignment-baseline","middle"),e.align){case"middle":t.setAttribute("text-anchor","middle"),t.setAttribute("startOffset","50%");break;case"end":t.setAttribute("text-anchor","end"),t.setAttribute("startOffset","100%");break;default:t.setAttribute("text-anchor","start"),t.setAttribute("startOffset","0%")}t.setAttribute("baseline-shift","0.5ex"),t.setAttribute("text-decoration",e.decoration),t.setAttribute("rotate",e.rotated?90:0),t.setAttribute("kerning",e.kerning?"auto":0),t.firstChild.data=e.text}}),p.TextPath.nodeType="text";var v=534<function(){var t=/WebKit\/(\d*)/.exec(g);return t?t[1]:0}();p.Surface=r("dojox.gfx.svg.Surface",u.Surface,{constructor:function(){u.Container._init.call(this)},destroy:function(){u.Container.clear.call(this,!0),this.defNode=null,this.inherited(arguments)},setDimensions:function(t,e){return this.rawNode?(this.rawNode.setAttribute("width",t),this.rawNode.setAttribute("height",e),v&&(this.rawNode.style.width=t,this.rawNode.style.height=e),this):this},getDimensions:function(){return this.rawNode?{width:l.normalizedLength(this.rawNode.getAttribute("width")),height:l.normalizedLength(this.rawNode.getAttribute("height"))}:null}}),p.createSurface=function(t,e,i){var r=new p.Surface;return r.rawNode=c(p.xmlns.svg,"svg"),r.rawNode.setAttribute("overflow","hidden"),e&&r.rawNode.setAttribute("width",e),i&&r.rawNode.setAttribute("height",i),e=c(p.xmlns.svg,"defs"),r.rawNode.appendChild(e),r.defNode=e,r._parent=s.byId(t),r._parent.appendChild(r.rawNode),l._base._fixMsTouchAction(r),r},e={_setFont:function(){var t=this.fontStyle;this.rawNode.setAttribute("font-style",t.style),this.rawNode.setAttribute("font-variant",t.variant),this.rawNode.setAttribute("font-weight",t.weight),this.rawNode.setAttribute("font-size",t.size),this.rawNode.setAttribute("font-family",t.family)}};var _=u.Container;return r=p.Container={openBatch:function(){if(!this._batch){var t;t=p.useSvgWeb?i.doc.createDocumentFragment(!0):i.doc.createDocumentFragment(),this.fragment=t}return++this._batch,this},closeBatch:function(){return this._batch=0<this._batch?--this._batch:0,this.fragment&&!this._batch&&(this.rawNode.appendChild(this.fragment),delete this.fragment),this},add:function(t){return this!=t.getParent()&&(this.fragment?this.fragment.appendChild(t.rawNode):this.rawNode.appendChild(t.rawNode),_.add.apply(this,arguments),t.setClip(t.clip)),this},remove:function(t){return this==t.getParent()&&(this.rawNode==t.rawNode.parentNode&&this.rawNode.removeChild(t.rawNode),this.fragment&&this.fragment==t.rawNode.parentNode&&this.fragment.removeChild(t.rawNode),t._removeClipNode(),_.remove.apply(this,arguments)),this},clear:function(){for(var t=this.rawNode;t.lastChild;)t.removeChild(t.lastChild);var e=this.defNode;if(e){for(;e.lastChild;)e.removeChild(e.lastChild);t.appendChild(e)}return _.clear.apply(this,arguments)},getBoundingBox:_.getBoundingBox,_moveChildToFront:_._moveChildToFront,_moveChildToBack:_._moveChildToBack},d=p.Creator={createObject:function(t,e){if(!this.rawNode)return null;var i=new t,s=c(p.xmlns.svg,t.nodeType);return i.setRawNode(s),i.setShape(e),this.add(i),i}},t.extend(p.Text,e),t.extend(p.TextPath,e),t.extend(p.Group,r),t.extend(p.Group,u.Creator),t.extend(p.Group,d),t.extend(p.Surface,r),t.extend(p.Surface,u.Creator),t.extend(p.Surface,d),p.fixTarget=function(t){return t.gfxTarget||(t.gfxTarget=x&&t.target.wholeText?t.target.parentElement.__gfxObject__:t.target.__gfxObject__),!0},p.useSvgWeb&&(p.createSurface=function(t,e,i){var r=new p.Surface;if(!e||!i){var n=o.position(t);e=e||n.w,i=i||n.h}t=s.byId(t);var n=t.id?t.id+"_svgweb":l._base._getUniqueId(),a=c(p.xmlns.svg,"svg");return a.id=n,a.setAttribute("width",e),a.setAttribute("height",i),svgweb.appendChild(a,t),a.addEventListener("SVGLoad",function(){r.rawNode=this,r.isLoaded=!0;var t=c(p.xmlns.svg,"defs");r.rawNode.appendChild(t),r.defNode=t,r.onLoad&&r.onLoad(r)},!1),r.isLoaded=!1,r},p.Surface.extend({destroy:function(){var t=this.rawNode;svgweb.removeChild(t,t.parentNode)}}),e={connect:function(e,i,s){return"on"===e.substring(0,2)&&(e=e.substring(2)),s=2==arguments.length?i:t.hitch(i,s),this.getEventSource().addEventListener(e,s,!1),[this,e,s]},disconnect:function(t){this.getEventSource().removeEventListener(t[1],t[2],!1),delete t[0]}},t.extend(p.Shape,e),t.extend(p.Surface,e)),p});